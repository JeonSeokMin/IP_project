<!DOCTYPE html>
<html>
  <head>
    <title>look_post</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 100px;
      }
      .chat-container {
        max-width: 600px;
        margin: 0 auto;
        border-radius: 5px;
        overflow: hidden;
      }
      .post_button {
        align-self: flex-end;
      }
      .avatar {
        font-size: 24px;
        margin-right: 10px;
      }
      .message-content {
        background-color: white;
        padding: 10px;
      }
      .message-options {
        display: flex;
        justify-content: flex-end;
      }
      .message-options button {
        margin: 0 5px;
        padding: 5px 10px;
        border: none;
        border-radius: 3px;
        background-color: #6c63ff;
        color: white;
        cursor: pointer;
      }
      .message-options button:hover {
        background-color: #4c47b5;
      }
      .separate-post-comment {
        margin-bottom: 20px;
      }
      .user-input-container {
        border: 2px solid #ddd;
        border-radius: 5px;
        margin-bottom: 10px;
      }
      .user-input {
        display: flex;
        margin: 10px 10px;
      }
      .user-input textarea {
        flex-grow: 1;
        padding: 5px;
        border: 1px solid #ddd;
        border-radius: 5px;
        height: 100px;
      }
      .user-input button {
        margin-left: 5px;
        padding: 5px 10px;
        border: none;
        border-radius: 3px;
        background-color: #6c63ff;
        color: white;
        cursor: pointer;
        height: 26px;
      }
      .user-input button:hover {
        background-color: #5a50e5;
      }
      .text_input {
        resize: none;
      }
      .person_info_container {
        display: flex;
        height: 40px;
        align-items: center;
      }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const postId = 1;  // 실제 포스트 ID로 교체해주세요
            const baseURL = "https://3.36.250.80:3000";  // 실제 BaseURL로 교체해주세요
            
            const postContainer = document.getElementById("post-container");
            const commentsContainer = document.getElementById("comments-container");
            const postButton = document.getElementById("post-button");
            const commentInput = document.querySelector(".text_input");
            
            // 포스트 데이터 가져오기
            axios.get(`${baseURL}/api/boards/${postId}`)
            .then(response => {
                const data = response.data;
                displayPost(data);
                displayComments(data.comments);
            })
            .catch(error => console.error('포스트 데이터를 가져오는 중 에러 발생:', error));
            
            // 포스트 표시하기
            function displayPost(post) {
                const postHTML = `
                <div class="message">
                    <div class="person_info_container">
                        <div class="avatar">&#128100;</div>
                        <p>${post.writerName}</p>
                    </div>
                    <div class="message-content">
                        <p>${post.content}</p>
                    </div>
                </div>
                <div class="message-options">
                    ${post.isMine ? '<button onclick="deletePost()">삭제</button>' : ''}
                </div>
                `;
                postContainer.innerHTML = postHTML;
            }

            // 댓글 표시하기
            function displayComments(comments) {
                commentsContainer.innerHTML = '';
                comments.forEach(comment => {
                const commentHTML = `
                    <div class="message">
                    <div class="person_info_container">
                        <div class="avatar">&#128100;</div>
                        <p>${comment.commentWriter}</p>
                    </div>
                    <div class="message-content">
                        <p>${comment.commentContent}</p>
                    </div>
                    ${comment.isMyComment ? '<div class="message-options"><button onclick="deleteComment(${comment.commentId})">삭제</button></div>' : ''}
                    </div>
                    <hr />
                `;
                commentsContainer.innerHTML += commentHTML;
                });
            }

            // 새로운 댓글 작성하기
            postButton.addEventListener("click", function() {
                const content = commentInput.value.trim();
                if (content) {
                axios.post(`${baseURL}/api/boards/${postId}/comments`, { content })
                    .then(response => {
                    commentInput.value = '';
                    displayComments(response.data.comments);  // 응답에 포함된 업데이트된 댓글을 표시합니다.
                    })
                    .catch(error => console.error('댓글을 작성하는 중 에러 발생:', error));
                }
            });
        });

        function deletePost() {
        // 포스트 삭제하는 코드를 여기에 작성하세요
        }

        function deleteComment(commentId) {
        // 댓글 삭제하는 코드를 여기에 작성하세요
        }

    </script>
  </head>
  <body>
    <div class="chat-body">
      <div id="post-container"></div>
      <hr class="separate-post-comment" />
      <div class="comment">
        <div class="user-input-container">
          <div class="user-input">
            <textarea id="comment-input" class="text_input" cols="30" rows="10"></textarea>
            <button id="post-button" class="post_button">작성하기</button>
          </div>
        </div>
        <div id="comments-container"></div>
      </div>
    </div>
  </body>
</html>
